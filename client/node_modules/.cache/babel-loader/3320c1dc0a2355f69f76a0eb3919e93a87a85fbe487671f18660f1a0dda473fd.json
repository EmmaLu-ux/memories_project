{"ast":null,"code":"import React,{useEffect}from'react';import{Paper,Typography,CircularProgress,Divider}from'@material-ui/core';import{useDispatch,useSelector}from'react-redux';import{useNavigate,useParams}from'react-router-dom';import moment from'moment';import useStyles from'./styles';import{getPost,getPostsBySearch}from'../../actions/posts';import CommentSection from'./CommentSection';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PostDetails=function PostDetails(){var classes=useStyles();var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.posts;}),post=_useSelector.post,posts=_useSelector.posts,isLoading=_useSelector.isLoading;var navigate=useNavigate();var _useParams=useParams(),id=_useParams.id;useEffect(function(){dispatch(getPost(id));},[id]);useEffect(function(){if(post){dispatch(getPostsBySearch({search:'',tags:post===null||post===void 0?void 0:post.tags.join(',')}));}},[post]);if(!post)return null;if(isLoading){return/*#__PURE__*/_jsx(Paper,{elevation:6,className:classes.loadingPaper,children:/*#__PURE__*/_jsx(CircularProgress,{size:\"7em\"})});}var recommendedPosts=posts.filter(function(_ref){var _id=_ref._id;return _id!==post._id;});var openPost=function openPost(_id){return navigate(\"/posts/\".concat(_id));};return/*#__PURE__*/_jsxs(Paper,{style:{padding:'20px',borderRadius:'15px'},elevation:6,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.card,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.section,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h3\",component:\"h2\",children:post.title}),/*#__PURE__*/_jsx(Typography,{gutterBottom:true,variant:\"h6\",color:\"textSecondary\",component:\"h2\",children:post.tags.map(function(tag){return\"#\".concat(tag,\" \");})}),/*#__PURE__*/_jsx(Typography,{gutterBottom:true,variant:\"body1\",component:\"p\",children:post.message}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"Created by: \",post.name]}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:moment(post.createdAt).fromNow()}),/*#__PURE__*/_jsx(Divider,{style:{margin:'20px 0'}}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Realtime Chat - coming soon!\"})}),/*#__PURE__*/_jsx(Divider,{style:{margin:'20px 0'}}),/*#__PURE__*/_jsx(CommentSection,{post:post}),/*#__PURE__*/_jsx(Divider,{style:{margin:'20px 0'}})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.imageSection,children:/*#__PURE__*/_jsx(\"img\",{className:classes.media,src:post.selectedFile||'',alt:post.title})})]}),(recommendedPosts===null||recommendedPosts===void 0?void 0:recommendedPosts.length)&&/*#__PURE__*/_jsxs(\"div\",{className:classes.section,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,children:\"\\u4F60\\u53EF\\u80FD\\u4E5F\\u559C\\u6B22\\uFF1A\"}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(\"div\",{className:classes.recommendedposts,children:recommendedPosts===null||recommendedPosts===void 0?void 0:recommendedPosts.map(function(_ref2,i){var title=_ref2.title,name=_ref2.name,message=_ref2.message,selectedFile=_ref2.selectedFile,likes=_ref2.likes,_id=_ref2._id;return/*#__PURE__*/_jsxs(\"div\",{style:{margin:'20px',cursor:'pointer'},onClick:function onClick(){return openPost(_id);},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:title}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",gutterBottom:true,children:name}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",gutterBottom:true,children:message}),/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle1\",children:[\"\\u559C\\u6B22\\uFF1A\",likes.length]}),/*#__PURE__*/_jsx(\"img\",{src:selectedFile,width:\"200px\"})]},i);})})]})]});};export default PostDetails;","map":{"version":3,"names":["React","useEffect","Paper","Typography","CircularProgress","Divider","useDispatch","useSelector","useNavigate","useParams","moment","useStyles","getPost","getPostsBySearch","CommentSection","PostDetails","classes","dispatch","state","posts","post","isLoading","navigate","id","search","tags","join","loadingPaper","recommendedPosts","filter","_id","openPost","padding","borderRadius","card","section","title","map","tag","message","name","createdAt","fromNow","margin","imageSection","media","selectedFile","length","recommendedposts","i","likes","cursor"],"sources":["/Users/emmalu/Documents/fronted/workspace/reactProjects/memories_project/client/src/components/PostDetails/PostDetails.jsx"],"sourcesContent":["import React, { useEffect } from 'react'\nimport { Paper, Typography, CircularProgress, Divider } from '@material-ui/core'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { useNavigate, useParams } from 'react-router-dom'\nimport moment from 'moment'\n\nimport useStyles from './styles'\nimport { getPost, getPostsBySearch } from '../../actions/posts'\nimport CommentSection from './CommentSection'\n\nconst PostDetails = () => {\n  const classes = useStyles()\n  const dispatch = useDispatch()\n  const { post, posts, isLoading } = useSelector(state => state.posts)\n  const navigate = useNavigate()\n  const { id } = useParams()\n\n  useEffect(() => {\n    dispatch(getPost(id))\n  }, [id])\n\n  useEffect(() => {\n    if(post){\n      dispatch(getPostsBySearch({ search: '', tags: post?.tags.join(',')}))\n    }\n  }, [post])\n\n  if(!post) return null\n\n  if(isLoading){\n    return <Paper elevation={6} className={classes.loadingPaper}>\n      <CircularProgress size='7em'/>\n    </Paper>\n  }\n  const recommendedPosts = posts.filter(({_id}) => _id !== post._id)\n\n  const openPost = (_id) => navigate(`/posts/${_id}`)\n  return (\n    <Paper style={{ padding: '20px', borderRadius: '15px' }} elevation={6}>\n      <div className={classes.card}>\n        <div className={classes.section}>\n          <Typography variant=\"h3\" component=\"h2\">{post.title}</Typography>\n          <Typography gutterBottom variant=\"h6\" color=\"textSecondary\" component=\"h2\">{post.tags.map((tag) => `#${tag} `)}</Typography>\n          <Typography gutterBottom variant=\"body1\" component=\"p\">{post.message}</Typography>\n          <Typography variant=\"h6\">Created by: {post.name}</Typography>\n          <Typography variant=\"body1\">{moment(post.createdAt).fromNow()}</Typography>\n          <Divider style={{ margin: '20px 0' }} />\n          <Typography variant=\"body1\"><strong>Realtime Chat - coming soon!</strong></Typography>\n          <Divider style={{ margin: '20px 0' }} />\n          {/* <Typography variant=\"body1\"><strong>Comments - coming soon!</strong></Typography> */}\n          <CommentSection post={post}/>\n          <Divider style={{ margin: '20px 0' }} />\n        </div>\n        <div className={classes.imageSection} >\n          <img className={classes.media} src={post.selectedFile || ''} alt={post.title} />\n        </div>\n      </div>\n      {recommendedPosts?.length && (\n        <div className={classes.section}>\n          <Typography variant='h5' gutterBottom>你可能也喜欢：</Typography>\n          <Divider />\n          <div className={classes.recommendedposts}>\n            {recommendedPosts?.map(({ title, name, message, selectedFile, likes, _id }, i) => (\n              <div style={{ margin: '20px', cursor: 'pointer' }} onClick={() => openPost(_id)} key={i}>\n                <Typography variant='h6' gutterBottom>{title}</Typography>\n                <Typography variant='subtitle2' gutterBottom>{name}</Typography>\n                <Typography variant='subtitle2' gutterBottom>{message}</Typography>\n                <Typography variant='subtitle1'>喜欢：{likes.length}</Typography>\n                <img src={selectedFile} width='200px'/>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </Paper>\n  )\n}\n\nexport default PostDetails"],"mappings":"AAAA,MAAOA,MAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,OAASC,KAAK,CAAEC,UAAU,CAAEC,gBAAgB,CAAEC,OAAO,KAAQ,mBAAmB,CAChF,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,WAAW,CAAEC,SAAS,KAAQ,kBAAkB,CACzD,MAAOC,OAAM,KAAM,QAAQ,CAE3B,MAAOC,UAAS,KAAM,UAAU,CAChC,OAASC,OAAO,CAAEC,gBAAgB,KAAQ,qBAAqB,CAC/D,MAAOC,eAAc,KAAM,kBAAkB,yFAE7C,GAAMC,YAAW,CAAG,QAAdA,YAAW,EAAS,CACxB,GAAMC,QAAO,CAAGL,SAAS,EAAE,CAC3B,GAAMM,SAAQ,CAAGX,WAAW,EAAE,CAC9B,iBAAmCC,WAAW,CAAC,SAAAW,KAAK,QAAIA,MAAK,CAACC,KAAK,GAAC,CAA5DC,IAAI,cAAJA,IAAI,CAAED,KAAK,cAALA,KAAK,CAAEE,SAAS,cAATA,SAAS,CAC9B,GAAMC,SAAQ,CAAGd,WAAW,EAAE,CAC9B,eAAeC,SAAS,EAAE,CAAlBc,EAAE,YAAFA,EAAE,CAEVtB,SAAS,CAAC,UAAM,CACdgB,QAAQ,CAACL,OAAO,CAACW,EAAE,CAAC,CAAC,CACvB,CAAC,CAAE,CAACA,EAAE,CAAC,CAAC,CAERtB,SAAS,CAAC,UAAM,CACd,GAAGmB,IAAI,CAAC,CACNH,QAAQ,CAACJ,gBAAgB,CAAC,CAAEW,MAAM,CAAE,EAAE,CAAEC,IAAI,CAAEL,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEK,IAAI,CAACC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACvE,CACF,CAAC,CAAE,CAACN,IAAI,CAAC,CAAC,CAEV,GAAG,CAACA,IAAI,CAAE,MAAO,KAAI,CAErB,GAAGC,SAAS,CAAC,CACX,mBAAO,KAAC,KAAK,EAAC,SAAS,CAAE,CAAE,CAAC,SAAS,CAAEL,OAAO,CAACW,YAAa,uBAC1D,KAAC,gBAAgB,EAAC,IAAI,CAAC,KAAK,EAAE,EACxB,CACV,CACA,GAAMC,iBAAgB,CAAGT,KAAK,CAACU,MAAM,CAAC,kBAAEC,IAAG,MAAHA,GAAG,OAAMA,IAAG,GAAKV,IAAI,CAACU,GAAG,GAAC,CAElE,GAAMC,SAAQ,CAAG,QAAXA,SAAQ,CAAID,GAAG,QAAKR,SAAQ,kBAAWQ,GAAG,EAAG,GACnD,mBACE,MAAC,KAAK,EAAC,KAAK,CAAE,CAAEE,OAAO,CAAE,MAAM,CAAEC,YAAY,CAAE,MAAO,CAAE,CAAC,SAAS,CAAE,CAAE,wBACpE,aAAK,SAAS,CAAEjB,OAAO,CAACkB,IAAK,wBAC3B,aAAK,SAAS,CAAElB,OAAO,CAACmB,OAAQ,wBAC9B,KAAC,UAAU,EAAC,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,UAAEf,IAAI,CAACgB,KAAK,EAAc,cACjE,KAAC,UAAU,EAAC,YAAY,MAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,SAAS,CAAC,IAAI,UAAEhB,IAAI,CAACK,IAAI,CAACY,GAAG,CAAC,SAACC,GAAG,mBAASA,GAAG,OAAG,CAAC,EAAc,cAC5H,KAAC,UAAU,EAAC,YAAY,MAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,UAAElB,IAAI,CAACmB,OAAO,EAAc,cAClF,MAAC,UAAU,EAAC,OAAO,CAAC,IAAI,WAAC,cAAY,CAACnB,IAAI,CAACoB,IAAI,GAAc,cAC7D,KAAC,UAAU,EAAC,OAAO,CAAC,OAAO,UAAE9B,MAAM,CAACU,IAAI,CAACqB,SAAS,CAAC,CAACC,OAAO,EAAE,EAAc,cAC3E,KAAC,OAAO,EAAC,KAAK,CAAE,CAAEC,MAAM,CAAE,QAAS,CAAE,EAAG,cACxC,KAAC,UAAU,EAAC,OAAO,CAAC,OAAO,uBAAC,wBAAQ,8BAA4B,EAAS,EAAa,cACtF,KAAC,OAAO,EAAC,KAAK,CAAE,CAAEA,MAAM,CAAE,QAAS,CAAE,EAAG,cAExC,KAAC,cAAc,EAAC,IAAI,CAAEvB,IAAK,EAAE,cAC7B,KAAC,OAAO,EAAC,KAAK,CAAE,CAAEuB,MAAM,CAAE,QAAS,CAAE,EAAG,GACpC,cACN,YAAK,SAAS,CAAE3B,OAAO,CAAC4B,YAAa,uBACnC,YAAK,SAAS,CAAE5B,OAAO,CAAC6B,KAAM,CAAC,GAAG,CAAEzB,IAAI,CAAC0B,YAAY,EAAI,EAAG,CAAC,GAAG,CAAE1B,IAAI,CAACgB,KAAM,EAAG,EAC5E,GACF,CACL,CAAAR,gBAAgB,SAAhBA,gBAAgB,iBAAhBA,gBAAgB,CAAEmB,MAAM,gBACvB,aAAK,SAAS,CAAE/B,OAAO,CAACmB,OAAQ,wBAC9B,KAAC,UAAU,EAAC,OAAO,CAAC,IAAI,CAAC,YAAY,eAAC,4CAAO,EAAa,cAC1D,KAAC,OAAO,IAAG,cACX,YAAK,SAAS,CAAEnB,OAAO,CAACgC,gBAAiB,UACtCpB,gBAAgB,SAAhBA,gBAAgB,iBAAhBA,gBAAgB,CAAES,GAAG,CAAC,eAAqDY,CAAC,KAAnDb,MAAK,OAALA,KAAK,CAAEI,IAAI,OAAJA,IAAI,CAAED,OAAO,OAAPA,OAAO,CAAEO,YAAY,OAAZA,YAAY,CAAEI,KAAK,OAALA,KAAK,CAAEpB,GAAG,OAAHA,GAAG,oBACtE,aAAK,KAAK,CAAE,CAAEa,MAAM,CAAE,MAAM,CAAEQ,MAAM,CAAE,SAAU,CAAE,CAAC,OAAO,CAAE,yBAAMpB,SAAQ,CAACD,GAAG,CAAC,EAAC,wBAC9E,KAAC,UAAU,EAAC,OAAO,CAAC,IAAI,CAAC,YAAY,eAAEM,KAAK,EAAc,cAC1D,KAAC,UAAU,EAAC,OAAO,CAAC,WAAW,CAAC,YAAY,eAAEI,IAAI,EAAc,cAChE,KAAC,UAAU,EAAC,OAAO,CAAC,WAAW,CAAC,YAAY,eAAED,OAAO,EAAc,cACnE,MAAC,UAAU,EAAC,OAAO,CAAC,WAAW,WAAC,oBAAG,CAACW,KAAK,CAACH,MAAM,GAAc,cAC9D,YAAK,GAAG,CAAED,YAAa,CAAC,KAAK,CAAC,OAAO,EAAE,GAL6CG,CAAC,CAMjF,EACP,CAAC,EACE,GAET,GACK,CAEZ,CAAC,CAED,cAAelC,YAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}