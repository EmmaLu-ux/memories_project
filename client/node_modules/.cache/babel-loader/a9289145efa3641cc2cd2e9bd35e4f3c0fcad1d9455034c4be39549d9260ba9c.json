{"ast":null,"code":"import _regeneratorRuntime from\"/Users/emmalu/Documents/fronted/workspace/reactProjects/memories_project/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/emmalu/Documents/fronted/workspace/reactProjects/memories_project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/emmalu/Documents/fronted/workspace/reactProjects/memories_project/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/emmalu/Documents/fronted/workspace/reactProjects/memories_project/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/emmalu/Documents/fronted/workspace/reactProjects/memories_project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{Avatar,Button,Typography,Paper,Grid,Container}from'@material-ui/core';import{LockOutlined}from'@material-ui/icons';import{GoogleLogin,GoogleOAuthProvider}from'@react-oauth/google';// 实现谷歌第三方的登录\nimport jwtDecode from'jwt-decode';import{useDispatch}from'react-redux';import{useNavigate}from'react-router-dom';import useStyles from'./styles';import Input from'./Input';// import Icon from './Icon'\nimport{AUTH}from'../../constants/actionTypes';import{signin,signup}from'../../actions/auth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var initialState={name:'',email:'',confirmPassword:'',password:''};var Auth=function Auth(){var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showPassword=_useState2[0],setShowPassword=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSignUp=_useState4[0],setIsSignUp=_useState4[1];var _useState5=useState(initialState),_useState6=_slicedToArray(_useState5,2),formData=_useState6[0],setFormData=_useState6[1];var dispatch=useDispatch();var navigate=useNavigate();/* form提交数据 */var handleSubmit=function handleSubmit(e){e.preventDefault();// console.log(formData)\nif(isSignUp){dispatch(signup(formData,navigate));}else{dispatch(signin(formData,navigate));}};var handleChange=function handleChange(e){// console.log('handleChange')\nsetFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},e.target.name,e.target.value)));// console.log('formData: ', formData)\n};var handleShowPassword=function handleShowPassword(){return setShowPassword(function(preShowPassword){return!preShowPassword;});};var switchMode=function switchMode(){setIsSignUp(function(prevIsSignUp){return!prevIsSignUp;});setShowPassword(false);};var googleSuccess=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(res){var result,token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:// console.log('google-login-success: ', res)\nresult=jwtDecode(res===null||res===void 0?void 0:res.credential);token=res===null||res===void 0?void 0:res.credential;// console.log(result)\ntry{dispatch({type:AUTH,playload:{result:result,token:token}});navigate('/',{replace:true});}catch(error){console.log(error);}case 3:case\"end\":return _context.stop();}},_callee);}));return function googleSuccess(_x){return _ref.apply(this,arguments);};}();var googleError=function googleError(error){console.log('google-login-error: ',error);};/* client-id: 511187713250-lau05uhtqlrq2hqfimct4m58umvrdmdr.apps.googleusercontent.com */ /* client-password: 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 */return/*#__PURE__*/_jsxs(Container,{component:\"main\",maxWidth:\"xs\",children:[\" \",/*#__PURE__*/_jsxs(Paper,{className:classes.paper,elevation:3,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.avatar,children:/*#__PURE__*/_jsx(LockOutlined,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:isSignUp?'注册':'登录'}),/*#__PURE__*/_jsxs(\"form\",{className:classes.form,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[isSignUp&&/*#__PURE__*/_jsx(Input,{name:\"name\",label:\"\\u7528\\u6237\\u540D\",handleChange:handleChange,autoFocus:true,type:\"text\"}),/*#__PURE__*/_jsx(Input,{name:\"email\",label:\"\\u90AE\\u7BB1\",handleChange:handleChange,type:\"email\"}),/*#__PURE__*/_jsx(Input,{name:\"password\",label:\"\\u5BC6\\u7801\",handleChange:handleChange,type:showPassword?'text':'password',handleShowPassword:handleShowPassword}),isSignUp&&/*#__PURE__*/_jsx(Input,{name:\"confirmPassword\",label:\"\\u518D\\u6B21\\u8F93\\u5165\\u5BC6\\u7801\",handleChange:handleChange,type:\"password\"})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit,children:isSignUp?'注册':'登录'}),/*#__PURE__*/_jsx(GoogleOAuthProvider,{clientId:\"\".concat(process.env.REACT_APP_GOOGLE_API_TOKEN),children:/*#__PURE__*/_jsx(GoogleLogin,{onSuccess:googleSuccess,onError:googleError,locale:\"zh_CN\"})}),/*#__PURE__*/_jsx(Grid,{container:true,justifyContent:\"flex-end\",children:/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{onClick:switchMode,children:isSignUp?'已有账号? 登录':'还没有账号? 马上注册'})})})]})]})]});};export default Auth;","map":{"version":3,"names":["React","useState","Avatar","Button","Typography","Paper","Grid","Container","LockOutlined","GoogleLogin","GoogleOAuthProvider","jwtDecode","useDispatch","useNavigate","useStyles","Input","AUTH","signin","signup","initialState","name","email","confirmPassword","password","Auth","classes","showPassword","setShowPassword","isSignUp","setIsSignUp","formData","setFormData","dispatch","navigate","handleSubmit","e","preventDefault","handleChange","target","value","handleShowPassword","preShowPassword","switchMode","prevIsSignUp","googleSuccess","res","result","credential","token","type","playload","replace","error","console","log","googleError","paper","avatar","form","submit","process","env","REACT_APP_GOOGLE_API_TOKEN"],"sources":["/Users/emmalu/Documents/fronted/workspace/reactProjects/memories_project/client/src/components/Auth/Auth.js"],"sourcesContent":["import React, { useState } from 'react'\nimport { Avatar, Button, Typography, Paper, Grid, Container } from '@material-ui/core'\nimport { LockOutlined } from '@material-ui/icons'\nimport { GoogleLogin, GoogleOAuthProvider } from '@react-oauth/google' // 实现谷歌第三方的登录\nimport jwtDecode from 'jwt-decode'\nimport { useDispatch } from 'react-redux'\nimport { useNavigate } from 'react-router-dom'\n\nimport useStyles from './styles'\nimport Input from './Input'\n// import Icon from './Icon'\nimport { AUTH } from '../../constants/actionTypes'\nimport { signin, signup } from '../../actions/auth'\n\nconst initialState = { name: '', email: '', confirmPassword: '', password: '' }\n\nconst Auth = () => {\n  const classes = useStyles()\n  const [showPassword, setShowPassword] = useState(false)\n  const [isSignUp, setIsSignUp] = useState(false)\n  const [formData, setFormData] = useState(initialState)\n  const dispatch = useDispatch()\n  const navigate = useNavigate()\n\n  /* form提交数据 */\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    // console.log(formData)\n    if (isSignUp) {\n      dispatch(signup(formData, navigate))\n    } else {\n      dispatch(signin(formData, navigate))\n    }\n  }\n\n  const handleChange = (e) => {\n    // console.log('handleChange')\n    setFormData({ ...formData, [e.target.name]: e.target.value })\n    // console.log('formData: ', formData)\n  }\n  const handleShowPassword = () => setShowPassword(preShowPassword => !preShowPassword)\n  const switchMode = () => {\n    setIsSignUp(prevIsSignUp => !prevIsSignUp)\n    setShowPassword(false)\n  }\n\n  const googleSuccess = async (res) => {\n    // console.log('google-login-success: ', res)\n    const result = jwtDecode(res?.credential)\n    const token = res?.credential\n    // console.log(result)\n    try {\n      dispatch({ type: AUTH, playload: { result, token } })\n      navigate('/', { replace: true })\n    } catch (error) {\n      console.log(error)\n    }\n  }\n  const googleError = (error) => {\n    console.log('google-login-error: ', error)\n  }\n  /* client-id: 511187713250-lau05uhtqlrq2hqfimct4m58umvrdmdr.apps.googleusercontent.com */\n  /* client-password: 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 */\n  return (\n    <Container component='main' maxWidth='xs'> {/* <main> 标签用于指定文档的主体内容。 */}\n      <Paper className={classes.paper} elevation={3}>\n        <Avatar className={classes.avatar}>\n          <LockOutlined />\n        </Avatar>\n        <Typography variant='h5'>{isSignUp ? '注册' : '登录'}</Typography>\n\n        <form className={classes.form} onSubmit={handleSubmit}>\n          <Grid container spacing={2}>\n            {isSignUp && <Input name='name' label='用户名' handleChange={handleChange} autoFocus type='text' />}\n            <Input name='email' label='邮箱' handleChange={handleChange} type='email' />\n            <Input name='password' label='密码' handleChange={handleChange} type={showPassword ? 'text' : 'password'} handleShowPassword={handleShowPassword} />\n            {isSignUp && <Input name='confirmPassword' label='再次输入密码' handleChange={handleChange} type='password' />}\n          </Grid>\n          <Button type='submit' fullWidth variant='contained' color='primary' className={classes.submit}>\n            {isSignUp ? '注册' : '登录'}\n          </Button>\n          <GoogleOAuthProvider clientId={`${process.env.REACT_APP_GOOGLE_API_TOKEN}`}>\n            <GoogleLogin\n              onSuccess={googleSuccess}\n              onError={googleError}\n              locale=\"zh_CN\"\n            ></GoogleLogin>\n          </GoogleOAuthProvider>\n          <Grid container justifyContent='flex-end'>\n            <Grid item>\n              <Button onClick={switchMode}>\n                {isSignUp ? '已有账号? 登录' : '还没有账号? 马上注册'}\n              </Button>\n            </Grid>\n          </Grid>\n        </form>\n      </Paper>\n    </Container>\n  )\n}\n\nexport default Auth"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}